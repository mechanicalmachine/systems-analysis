# Анализ Систем. Урок 3

## Определяем стейкхолдеров

Исходя из требований к проекту имеют отношение 7 групп стейкхолдеров - по ним мы уже имеем консёрны. Плюс есть еще 3 группы, по которым консерны не указаны.

![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/053651ea-7eb2-4cc9-a1ad-d1143f825fd9)

![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/e77e9c52-f94b-497d-b562-e67cccd56b8e)

Все консерны известные на данный момент по всем стейкхолдерам сведены в следующую таблицу

 **ID**    | **Стейкхолдер**              | Консёрны                                                                                                     |
-----------|------------------------------|--------------------------------------------------------------------------------------------------------------|
 1         | Топ-менеджмент               | скоринг потенциальных работников уникален в своём роде, и логика его работы сильно выше, чем планировалось. Бизнес в будущем хочет продавать его другим компаниям и тестировать больше гипотез;<br><br>релизный цикл для всей системы — месяц, для скоринга работников — неделя максимум. |
 2         | Менеджеры                    | хотят, чтобы о системе ставок не знали другие отделы, иначе будет некрасивая ситуация. Они хотят скрыть эту систему даже от разработчиков, которые не будут ей заниматься, и от начальства;<br><br> выяснилось, что котам из Happy Cat Box наш проект понравился, поэтому приходит не 10 заказов в день, а 10 заказов в минуту.                              |
 3         | Финотдел                     | списывать деньги с клиентов каждую неделю слишком затратно для отдела, поэтому они хотят списывать деньги раз в месяц, но платить воркерам и дальше раз в неделю. При этом необходимо постоянно добавлять новые способы списания денег для клиентов. Воркеры всегда работают через компанию «Золотая шляпа»;<br><br>боятся потерять любую финансовую информацию и хотят решение, которое будет гарантировать, что всё будет ок. |
 4         | Разработчики                 | система должна работать без сбоев, а если сбой случается, то должно быть понятно, что и где чинить.          |
 5         | Админы                       | простота мониторинга системы для своевременного замечания сбоев, чтобы не работать в авральном режиме.       |
 6         | Юристы                       | соответствие всей системы правовым нормам.                                                                   |
 7         | Клиенты                      | ожидаемое поведение системы: без сбоев и тупняков.                                                           |
 8         | Работники склада расходников |                                                                                                              |
 9         | Коты-воркеры                 |                                                                                                              |
 10        | Коты-датасаентисты           |                                                                                                              |

## Ограничения MCP

- инфраструктуру считаем бесплатной, прямо как в уроке, так как Happy Cat Box расскажет нам, как такое организовать;

- соблюдение CatFinComplience, который говорит об особом способе хранения данных и особой наблюдаемости за системой. Компания не хочет повторять опыт с маски-шоу, которые были в Happy Cat Box.

## Определение характеристик системы

### Характеристики системы, найденные в прошлом подходе:

 - высокие **scalability** и **elasticity** для боундед-контекста "Обработка заявок от воркеров-кандидатов и тестирование" исходя из условия `[US-081] Мы ожидаем 1к заявок в день от рандомных котов`;
 - высокие **agility**, **testability** и **deployability** исходя из условий `Бизнесу необходим низкий ТТМ (Time To Market), чтобы конкурировать на рынке.` для системы в целом;
 - высокие **evolvability** и **modifiability** для боундед-контекста "Определение характеристик воркера, основанное на результате тестирования" из-за требования `Для бизнеса критично проверять новые гипотезы по отсеву котов и изменять уже существующие с максимальной скоростью и надёжностью.`;
 - **high model complexity**, а значит, **modifiability** и **maintainability**, которые относятся к двум поддоменам «Найм лучших исполнителей» и «Определение лучшего исполнителя для заказа». Мы взяли эту характеристику из характеристик core-поддоменов. Важно учитывать, что для этих core-поддоменов нужен низкий каплинг;
 - высокие **scalability**, **modifiability**, **maintainability**, **testability**, **agility** и **evolvability** для всей системы потому что она находится на этапе роста.

### Новые характеристики, найденные через стейкхолдеров:
- для боундед-контекста "Определение характеристик воркера, основанное на результате тестирования" должен быть также высокий показатель **scalability** так как топ-менеджмент планирует продавать этот функционал другим компаниям 
- **релизный цикл месяц** для всей системы, за исключением боундед-контекста «Определение характеристик воркера, основанное на результате тестирования», для него **релизный цикл неделя максимум**. Это требование от топ-менеджмента;
- высокие показатели **scalability** и **elasticity** для боундед-контекста "Оформление заказа и изменение статуса заказов" так как от менеджеров появилась информация: выяснилось, что котам из Happy Cat Box наш проект понравился, поэтому приходит не 10 заказов в день, а 10 заказов в минуту.
- высокие значения **evolvability** и **modifiability** для боундед-контекстов "Расчет и выплата зарплат и премий для воркеров" и "Расчет и списание затрат у клиентов", это важно для Финотдела
- высокий показатель **maintainability** для всей системы, это важно для разработчиков и админов
- высокий показатель **reliability** (или **fault-tolerance**?) для всей системы, это важно для разработчиков и клиентов

## Разбивка характеристик системы по боундед-контекстам

![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/98eb8520-b0fa-4e4d-aab5-59e68b0beda5)
В полном размере доступна в Miro: [Характеристики системы с разбивкой по боундед-контекстам](https://miro.com/app/board/uXjVMJdmY9o=/?moveToWidget=3458764555746571627&cot=14)

## Выбор архитектурного стиля

В качестве архитектурного стиля выбраны микросервисы.

### Разбивка системы на атомарные элементы

![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/d9592514-5d1f-4f66-a0b4-75b1cacd5edb)

### Объединение атомарных элементов в сервисы

![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/85b007ad-5b40-42a4-aad3-8bd07bfb38fd)

 Атомарные элементы объеденены в сервисы по следующим кретериям:
 - "Производство fur-tune печенья" - услуга предоставляемая внешней организацией. Так как внешняя организация и ей необоходимо только отправить информацию о заказе - предполагем что сервис у них уже реализован и с нем надо только заинтегрироваться;
 - "Система ставок и определния победителей" - менеджеры хотят что бы об этой системе знало как можно меньшее кол-во лиц, в т.ч. разработчиков. Кроме того системе необходимо знать минимальное кол-во информации о заказах и их статусе, соответственно нет смысла объединять ее с какой-либо другой системой;
 - "Инвентаризация и склад" - простая система, которой необходимо знать некоторые данные о заказе, нет смысла объединять ее с любой другой системой;
 - "Расчет и выплата зарплат и премий воркерам" - финотдел постоянно хочет добавлять новые способы оплаты. Что бы релиз нового способа оплаты не ждал окончания тестирования фичи в другом сервисе - есть смысл вынести его в отделный сервис;
 - "Расчет и списание затрат у клиентов" - тоже что и в предыдущем пункте, но не объединен с предыдущим пунктом, так как технически они хоть и похожи, но имеют отношение к совершенно разным бизнес-процессам;
 - "Система оформления и обработки заказов" и "Менеджмент качества выполнения заказов" объеденины в один сервис, так как плотно работают с одними данными;
 - "Определение характеристик, основанное на результатах тестирования" - так как это единственное место в системе у которого релизный цикл - 1 день и что бы не заблокировать релиз недотестированной фичей в другом сервисе - этот сервис выделен в отдельный сервис; 
 - "Обработка заявок от воркеров-кандидатов и тестирование" относится к поддомену "Найм лучших исполнителей", но не объединен с другим сервисом в один, так как они имеют разные релизные циклы
 - "Система выбора воркера для заказа" - по описанию это отдельная система, состоящая из нейронок и пайплайнов, нет смысло ее объединять с любым другим компонентом системы.

### Выбор Базы Данных

- сервисы "Расчет и выплата зарплат и премий воркерам" и "Расчет и списание затрат у клиентов" должны соблюдать CatFinComplience и из-за требований к consistency выбираем для этих сервисов изолированные реляционные базы;
- коты-дата-саентисты работают со слаботипизированным и неструктурированным набором данных, им подойдёт графовая база данных;
- для всех остальных сервисов выбираем изолированные реляционные БД, что бы не синхронизировать миграции между сервисами.

### Выбор стиля коммуникаций

TODO: закончить выбор нужных стилей коммуникаций и их вид (синхронный/асинхронный). Опишите, почему вы сделали такой выбор и какие критерии использовали для выбора;

 - "Определение характеристик воркера, основанное на результате тестирования" - асинхронный event-driven стиль

 - "Расчет и выплата зарплат и премий для воркеров" - асинхронный event-driven стиль
 ![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/90522b78-a41d-435f-8483-49a00c1b97bf)
 - "Матчинг заказов на воркеров"...

### Автоматическая проверка ограничений (fitness functions)
 TODO: предположите, какие фитнес-функции можно использовать для валидации итоговой системы. Можете считать, что система будет делаться с использованием любого языка программирования, следовательно, можете выбрать любые инструменты из любой экосистемы;

### Architectural decision records, ADR
 TODO: сделайте ADR, опишите принятие решения по изоляции одного из элементов как изолированного сервиса.
