# Анализ Систем. Урок 2

## ES диаграмма из первого урока
 ![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/657d2c64-0423-466c-ba8d-1015c42228e7)
 [ES диаграмма из первого урока в Miro](https://miro.com/app/board/uXjVMJdmY9o=/?moveToWidget=3458764554585875502&cot=14)


## Модель данных
 - TODO добавить скрин модели данных
 - TODO добавить ссылку на доску Miro


## Поддомены MCP

![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/daa61ec4-b0ef-4e37-b4bb-3ee9595e67cc)


## Характеристики поддоменов

| Вид поддомена                                 | Конкурентное преимущество     | Сложность         | Изменчивость        | Варианты реализации     | Интерес проблемы       | Предполагаемый вид поддомена      |
|-----------------------------------------------|-------------------------------|-------------------|---------------------|-------------------------|------------------------|-----------------------------------|
| Работа с заказами                             | нет                           | высокая           | редкая              | ???                     | низкий                 | generic                           |
| Матчинг воркеров на заказы                    | да                            | высокая           | частая              | ???                     | высокий                | core                              |
| Хранение и сбор расходников                   | нет                           | низкая            | редкая              | ???                     | низкий                 | generic                           |
| Поиск и определение характеристик воркеров    | да                            | высокая           | частая              | ???                     | высокий                | core                              |
| Ставки                                        | нет                           | низкая            | редкая              | ???                     | низкий                 | supporting                        |
| Биллинг для клиентов                          | нет                           | высокая           | редкая              | купить готовое решение  | низкий                 | generic                           |


## MCP Core Domain Chart

![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/f56c79a0-fb8b-4be3-bdb0-039c492b3caf)


## Маппинг боундед-контекстов на поддомены

| Вид поддомена                                 | Предполагаемый вид поддомена      | Выделенный боундед-контекст                                                 |
|-----------------------------------------------|-----------------------------------|-----------------------------------------------------------------------------|
| Работа с заказами                             | generic                           | подписка на SaaS e-coTmmerce [elasticpath](https://www.elasticpath.com/)    |
| Матчинг воркеров на заказы                    | core                              | Система выбора воркера для заказа                                           |
| Хранение и сбор расходников                   | generic                           | Инвентаризация и склад                                                      |
| Поиск и определение характеристик воркеров    | core                              | ???                                                                         |
| Ставки                                        | supporting                        | Система ставок и определния победителей                                     |
| Биллинг для клиентов                          | generic                           | Расчет и списание затрат у клиентов                                         |


![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/82c19893-421f-429a-a92e-e85d30fb7de3)


## Сравнение разницы боундед-контекстов после из первого урока и после разбивки боунд-контекстов на поддомены

Элементы, получившиеся после первого урока:
![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/9d90cd68-15d7-45b5-a43f-26dc6ee0c4dd)

В двух выделенных местах 4 боундед-контекста из ES-модели, которые не сошлись с тем, что получилось после анализа поддоменов и боундед-контекстов.
![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/c7da0d97-7866-4016-9a5a-b4cdd6c49f19)

Проанализируем группу #2, состояющую из 2-х боундед-контекстов: поиска, определение характеристик воркера и матчинга. Изначально предполагалось, что
все процессы разбиваются на два контекста, при этом они связаны между собой, так как необходимы для определеня характеристик воркера и матчинга его на заказы.
Но после анализа поддоменов и боундед-контекстов оказалось, что поддомен "Поиск и определение характеристик воркеров" состоит из трех частей: 
Обработка заявок от воркеров-кандидатов и тестирование, определение характеристик, основанное на результатах тестирования, расчет и выплата зарплат и премий.
Получается, что, выбрав для поиска контекстов один только Event Storming, мы совершили ошибку.

Группировка сделанная изначально:                                                                                                | Группировка после анализа поддоменов и боундед-контекстов:
---------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------
![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/f47ff83a-5c20-4780-afeb-6cb71714dd46)       | ![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/7c7cfcd1-999c-43a6-9107-ff49d0800c73)

Определяем связи между боундед-контекстами:
![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/d9c4580b-9ab2-448e-a048-46d4c17b91a1)


## Обновленная после анализа поддоменов и боундед-контекстов ES-диаграмма
![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/41e077e9-c2cf-4aaa-bc8c-d362bfbe1251)
[Обновленная ES-диаграмма в Miro](https://miro.com/app/board/uXjVMJdmY9o=/?moveToWidget=3458764555199476231&cot=14)


## Обновленная после анализа поддоменов и боундед-контекстов модель данных
TODO обновить модель данных


## Выбираем стиль для MCP

Наиболее важные характеристики системы:
 - **scalability** и **elasticity** общая нагрузка будет не большая: `Общая нагрузка на систему не будет превышать 10 заказов в день и 100 клиентов. Воркеров будет 20 человек.`,
  но условие `[US-081] Мы ожидаем 1к заявок в день от рандомных котов` говорит нам что нагрузка на систему (точнее на ее части) все же будет, при этом она сокрее всего будет распределена не равномерно,
  вряд ли заявки будут создаваться ночью, пик нагрузки скорее всего будет приходиться на после обеденное время и надо уметь скейлить необходимые части системы под этот рост;
 - **agility**, **testability** и **deployability** исходя из условий `Бизнесу необходим низкий ТТМ (Time To Market), чтобы конкурировать на рынке.` и 
  `Для бизнеса критично проверять новые гипотезы по отсеву котов и изменять уже существующие с максимальной скоростью и надёжностью.`;
 - **evolvability** и **modifiability** из за требования `Для бизнеса критично проверять новые гипотезы по отсеву котов и изменять уже существующие с максимальной скоростью и надёжностью.`.
  Помимо этого **modifiability** требуется для того, что нужен низкий каплинг для двух core-поддоменов;
 - **scalability**, **modifiability**, **maintainability**, **testability**, **agility** и **evolvability**, потому что система находится на этапе роста.

Выделим зеленым все требуемые характеристики в таблице сравнения характеристик разных стилей построения систем
![изображение](https://github.com/mechanicalmachine/systems-analysis/assets/30704273/d9485140-79c9-4ed3-a0f1-ca922148e4bd)

Исходя из таблицы сравнения разных стилей построения систем для реализации MCP наилучшим образом подходит **микросервисная архитектура**. 
Но так как микросервисная архитектура наиболее дорогой тип архитектуры для реализации - связи между поддоменами будут синхронными, что позволит несколько сократить финансовые и 
временные затраты на реализацию системы.






















